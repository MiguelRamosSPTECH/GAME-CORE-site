<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../../css/dash_sre.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
    <script src="../../js/sessao.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11" defer></script>
</head>

<body>
    <div class="container-all">
        <div class="nav-lateral">
            <div class="logo-dbg">
                <img src="../../assets/imgs/DBG.-logo2png.png" alt="">
            </div>
            <div class="options-nav ">
                <div class="principal-options">
                    <div class="circle-option">
                        <i onclick="window.location.href='#'" class="fa-solid fa-house"></i>
                        <span class="texto-oculto">Início</span>
                    </div>
                    <div class="circle-option">
                        <i onclick="window.location.href='dashHistoricoAlertaSRE.html'" class="fa-solid fa-bug"></i>
                        <span class="texto-oculto">Alertas</span>
                    </div>
                    <div class="circle-option">
                        <i class="fa-solid fa-notes-medical" onclick="window.location.href='dashSaudeServidores.html'"></i>
                        <span class="texto-oculto">Configurações</span>
                    </div>
                </div>
                <div class="area-logoff">
                    <div class="circle-option logoff" onclick="limparSessao()">
                        <i class="fa-solid fa-right-from-bracket"></i>
                        <span class="texto-oculto" style="color: red;">Sair</span>
                    </div>
                </div>
            </div>
        </div>


        
        <div class="corpo">
            <div class="intervalo" >Intervalos de um Desvio-Padrão previstos para os proximos dias  
              <img onclick="mostrar_aviso()" class="toll_tip" src="../../assets/imgs/toll tip.png" height="45px"></div>

            <div class="kpi1">
                <p class="titulo_kpi">CPU Esperada:</p>
                <div class="metade" id="box_1cpu">
                    <p class="desc_metade" id="atual_cpu">2ª metade de novembro <b>(<u>atual)</u></b></p>

                    <p class="medida_metade" id="1_cpu">77%  a 97%</p>
                </div>

                <div class="metade" id="box_2cpu">
                    <p class="desc_metade" id="proxima_cpu">1ª metade de Dezembro  <b>(<u>seguinte)</u></b> </p>

                    <p class="medida_metade" id="2_cpu">80%  a 87%</p>
                </div>

        
            </div>

        
            <div class="kpi2">
            <p class="titulo_kpi">RAM Esperada:</p>
        
                    <div class="metade" style="border-color: green;" id="box_1ram">
                    <p class="desc_metade" id="atual_ram">2ª metade de novembro <b>(<u>atual)</u></b></p>

                    <p class="medida_metade" id="1_ram">55% a 60%</p>
                </div>

                <div class="metade" style="border-color: yellow; " id="box_2ram">
                    <p class="desc_metade" id="proxima_ram">1ª metade de Dezembro  <b>(<u>seguinte)</u></b> </p>

                    <p class="medida_metade" id="2_ram">66% a 70%</p>
                </div>
        </div>

            <div class="vazio"></div>
            <div class="graf">
                <canvas id="grafico"></canvas>
            </div>

        </div>

        <div class="direita_pai">

        <div class="direita1">
            <p class="titulo_direita1">Servidores com Risco de Alerta na CPU nas próximas 3 horas</p>    

            <table class="lista_sv" id="tabela">
                <tr>
                    
                </tr>
                <tr>
                    <td><img src="../../assets/imgs/bandeira_brasil.png" width="50%" ></td>
                    <td>minecraft-main</td>
                    <td style="color: red;">5</td>

                </tr>
                                <tr>
                    <td><img src="../../assets/imgs/bandeira_brasil.png" width="50%" ></td>
                    <td>minecraft-main</td>
                    <td style="color: red;">5</td>

                </tr>
            </table>
        </div>


        <div class="direita2"> 
            <p class="titulo_direita1">Alertas previstos por componente em 3 horas</p>                
            
            <canvas id="graf_pizza"></canvas>
        </div>

            
        </div>            


    </div>


    <div id="popup" class="popup">
    <div class="popup_conteudo">
        <p>Nos períodos informados abaixo, aproximadamente 68% do tempo, a porcentagem de uso estará dentro da sua respectiva faixa prevista</p>

        <button onclick="fechar_popup()" class="fechar_popup">Fechar</button>
    </div>
</div>


<p class="titulo">SRE - Previsão de consumo |  Servidores </p>
    <script>

      function mostrar_aviso() {
    document.getElementById("popup").style.display = "flex";
}

function fechar_popup() {
    document.getElementById("popup").style.display = "none";
}










        // LÓGICA DE HOVER DA BARRA LATERAL
        const navLateral = document.querySelector('.nav-lateral');
        const conteudo = document.querySelector('.conteudo');

        navLateral.addEventListener('mouseenter', () => {
            conteudo.classList.add('expand');
        });

        navLateral.addEventListener('mouseleave', () => {
            conteudo.classList.remove('expand');
        });



                const ctx2 = document.getElementById('graf_pizza').getContext('2d');
        

        new Chart(ctx2, {
            type: 'pie',
            data: {
                labels: ["CPU", "RAM"],
                datasets: [{
                    label: 'CPU',
                    data: [20,30],
                    backgroundColor: ['#6ce5e8', '#16c4d4'],
                    borderColor: '#6ce5e8',
                    borderWidth: 3,
                    fill: false,
                    tension: 0.4,
                    pointRadius: 0,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true },
                    title: {
                        display: true,
                        color: 'white',
                        font: {
                            size: 20,
                            weight: 'bold',
                            family: 'Open Sans'
                        },
                        align: 'center',
                        padding: {
                            top: -25
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: { color: 'white' },
                        grid: { display: false }
                    },
                    y: {
                        ticks: { color: 'white' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    }
                },
                layout: {
                    padding: 10
                }
            }
        });


    </script>
</body>

<script>
// Script backend em si:

var alertaGravevar = 0
var alertaLevevar = 0



// entrar()

 function entrar() {
        

        var idEmpresa = sessionStorage.ID_EMPRESA

        console.log("FORM idEmpresa: ", idEmpresa);


        fetch(`/sre_futuro/entrar/`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idServer: idEmpresa,
            })
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);
                // PEGAR do sessionStorage = var idEmpresa = sessionStorage.ID_EMPRESA;
                // Salvar no sessionStorage = sessionStorage.EMAIL_USUARIO = json.email;
                resposta.json().then(json => {
                    console.log(json);
                    console.log("Print do SRE FUTURO:");
                    
                    console.log(JSON.stringify(json));

                    
                    alertaLevevar = Number ((json[0].alertaLeve));
                    alertaGravevar = Number ((json[0].alertaGrave));

                    buscarServidores()
                
                    
                    

                });

            } else {

                console.log("Houve um erro ao tentar realizar o as previsões com alertas!");

                resposta.text().then(texto => {
                    console.error(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;
    }

    
    var nomesServidores = []
    var localizacaoServidores = []
    var macServidor = []
    var idServidor = []


  function buscarServidores() {
        
        var idEmpresa = sessionStorage.ID_EMPRESA

        console.log("FORM idEmpresa: ", idEmpresa);


        fetch(`/sre_futuro/buscar/`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idServer: idEmpresa,
            })
        }).then(function (resposta) {
            console.log("ESTOU NO THEN DO buscarServidores()!")

            if (resposta.ok) {
                console.log(resposta);
                // PEGAR do sessionStorage = var idEmpresa = sessionStorage.ID_EMPRESA;
                // Salvar no sessionStorage = sessionStorage.EMAIL_USUARIO = json.email;
                resposta.json().then(json => {
                    console.log(json);
                    console.log("Print do SRE FUTURO: Lista de servidores:");
                    
                    console.log(JSON.stringify(json));

                        for(i = 0; i < json.length; i++){
                            nomesServidores.push(json[i].apelido);
                            localizacaoServidores.push(json[i].localizacao);
                            macServidor.push(json[i].macadress);
                            idServidor.push(json[i].id);

                        }



                        montar()
                    
                    

                });

            } else {

                console.log("Houve um erro ao tentar realizar o as previsões com alertas!");

                resposta.text().then(texto => {
                    console.error(texto);
                });
            }

        }).catch(function (erro) {
            console.log(erro);
        })

        return false;
    }


    var kpis = {
        cpumin1 : 0,
        cpumax1: 0,
        cpumin2: 0,
        cpumax2: 0,

        rammin1: 0,
        rammax1: 0,
        rammin2: 0,
        rammax2: 0,
    }







// montando o Site:


function montar() {

    var dataAtual = new Date();
    var mes = dataAtual.getMonth()
    var dia = dataAtual.getDate()

    var nomesMeses = [
    "Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho",
    "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"
]

    var texto = ''
    var texto2 = ''


    if(dia >= 15){
        texto += "2ª"
        texto2 += `1ª metade de ${nomesMeses[mes +1]} <b>(<u>seguinte)</u></b>`
    }else{
        texto += "1ª"
        texto2 += `2ª metade de ${nomesMeses[mes]} <b>(<u>seguinte)</u></b>`
    }
    

    texto += ` metade de ${nomesMeses[mes]} <b>(<u>atual)</u></b>`
    

    document.getElementById("atual_cpu").innerHTML = texto
    document.getElementById("atual_ram").innerHTML = texto

    document.getElementById("proxima_ram").innerHTML = texto2
    document.getElementById("proxima_cpu").innerHTML = texto2



    texto = `${kpis.cpumin1}%  a ${kpis.cpumax1}%`
    texto2 = `${kpis.cpumin2}%  a ${kpis.cpumax2}%`

    document.getElementById("1_cpu").innerHTML = texto
    document.getElementById("2_cpu").innerHTML = texto2


    texto = `${kpis.rammin1}%  a ${kpis.rammax1}%`
    texto2 = `${kpis.rammin2}%  a ${kpis.rammax2}%`

    document.getElementById("1_ram").innerHTML = texto
    document.getElementById("2_ram").innerHTML = texto2


    // cores das caixas das KPIs:
    if(kpis.cpumax1 >= alertaLevevar){
        document.getElementById("box_1cpu").style.borderColor  = "yellow";
    } else {document.getElementById("box_1cpu").style.borderColor  = "green";}

    if(kpis.cpumax1 >= alertaGravevar){
        document.getElementById("box_1cpu").style.borderColor  = "red";
    }



    if(kpis.cpumax2 >= alertaLevevar){
        document.getElementById("box_2cpu").style.borderColor  = "yellow";
    }else {document.getElementById("box_2cpu").style.borderColor  = "green";}

    if(kpis.cpumax2 >= alertaGravevar){
        document.getElementById("box_2cpu").style.borderColor  = "red";
    }


    if(kpis.rammax1 >= alertaLevevar){
        document.getElementById("box_1ram").style.borderColor  = "yellow";
    }else {document.getElementById("box_1ram").style.borderColor  = "green";}

    if(kpis.rammax1 >= alertaGravevar){
        document.getElementById("box_1ram").style.borderColor  = "red";
    }


    if(kpis.rammax2 >= alertaLevevar){
        document.getElementById("box_2ram").style.borderColor  = "yellow";
    }else {document.getElementById("box_2ram").style.borderColor  = "green";}

    if(kpis.rammax2 >= alertaGravevar){
        document.getElementById("box_2ram").style.borderColor  = "red";
    }

}







// Pegando os valores do bucket:

var CpuServidores = {}
var RamServidores = {}
var horarioServidores = {}
var terAlertaLevesServidores = {}
var terAlertaGravesServidores = {}

    mandarBuscar ()

    async function mandarBuscar (){
            

        // Logica para pegar os dados de todos os servidores daquela empresa:]
        
        for ( var i = 0; i < macServidor.length; i++){

            let NOME_ARQUIVO = `${dia}/${macServidor[i]}/dados_capturados.csv`;
            let URL_API = `/s3Route/dados/${NOME_ARQUIVO}`;
            await buscarDados(URL_API, macServidor[i],"CpuServidores","RamServidores", "cpu_porcentagem","ram_porcentagem")
            // Adiona os valores de CPU e RAM nos objetos criados acima de todos os servidores cadastrados, do dia de hoje
        }




    }
        
        
        
        
        async function buscarDados(URL_API,mac,obj1, obj2, valor1, valor2) {
            
            

            
            // Referência ao canvas principal e ao container auxiliar para mensagens de erro
            
            // const ctx = document.getElementById('grafico');
            // const carregamento = document.getElementById('area_comparativo_servidores');
            
            // carregamento.innerHTML = 'Carregando dados...'; 
            
            try {
                // requisição à API
                let resposta = await fetch(URL_API);

            // descreve erros 
            if (!resposta.ok) {
                let erroDetalhe = await resposta.text();
                throw new Error(`Erro ${resposta.status}: Falha na API: ${erroDetalhe.substring(0, 100)}`);
            }
            
            // converte a resposta para JSON!!!!!
            let data = await resposta.json();

            // // limpa a mensagem de carregamento
            // carregamento.innerHTML = '';
            // carregamento.appendChild(ctx); // Garante que o canvas volte

            // verifica e Processa os Dados para o Chart.js
            if (!Array.isArray(data) || data.length === 0) {
                console.warn("Erro nos dados recebidos");
                // carregamento.innerHTML = `<div style="color: orange; padding: 20px;">⚠️ Dados vazios para plotar o gráfico.</div>`;
                return;
            }


            // extrai os valores para os eixos

            obj1[mac] = data.map(d => Number(d[valor1]));
            obj2[mac] = data.map(d => Number(d[valor2]) || 0);
            horarioServidores[mac] = data.map(d => Number(d[timestamp]));



            // Se for a ultima chamada dessa função, ela faz o codigo abaixo, que gera o predict de alerta pra cada servidor
            
            if (mac == macServidor[macServidor.length -1]){
                
                fazerPredict()

            }
        }
                 catch (error) {
            // Captura e exibe erros
            console.error("Erro ao carregar os dados:", error);
        }

        console.log("");
        
    }


    function fazerPredict() {

    const agora = Date.now();
    const referencia = 10800000; // 3 horas em ms

    // Pra cada servidor capturado vai rodar esse for
    for (let j = 0; j < macServidor.length; j++) {

        const mac = macServidor[j]; // servidor atual
        const dadosCPU = CpuServidores[mac];
        const horarios = horarioServidores[mac];

        // Filtrar pra pegar só as ultimas 3hrs pra ser mais preciso no predict
        var cpu3h = [];
        var horarios3h = [];

        for (let i = 0; i < horarios.length; i++) {
            if ((agora - horarios[i]) <= referencia) {
                cpu3h.push(dadosCPU[i]);
                horarios3h.push(horarios[i]);
            }
        }

        const n = cpu3h.length;

        // Criar o vetor X [0,1,2,3] já que o gap de tempo tem que ser o mesmo sempre
        var x = [];
        for (var i = 0; i < n; i++) {
            x.push(i);
        }

        
        var y = cpu3h; // dados das ultimas 3hrs

        // Somatórias
        var somaX = 0;
        var somaY = 0;
        var somaXY = 0;
        var somaX2 = 0;

        for (let i = 0; i < n; i++) {
            somaX += x[i];
            somaY += y[i];
            somaXY += x[i] * y[i];
            somaX2 += x[i] * x[i];
        }

        // Coeficientes da regressão linear (a + b*x)
        var b = (n * somaXY - somaX * somaY) / (n * somaX2 - somaX * somaX);
        var a = (somaY - b * somaX) / n;

        // Logica da previsão da bagaceira:

        // var proximoX = n; // próximo índice
        // var previsao = a + b * proximoX; // formula para prever os proximos valores

        if (b > 0){
                    var horarioAlertaLeve = (alertaLevevar - a) / b

                    var horarioAlertaGrave = (alertaGravevar - a) / b

            // Isso me dá daqui a quantas medidas vai ter o alerta
        }


        if(horarioAlertaLeve < n){
            terAlertaLevesServidores[mac]=horarioAlertaLeve
        }
        
        if(horarioAlertaGrave < n){
            terAlertaGravesServidores[mac]=horarioAlertaGrave
        }
    }

}




function listarServidores() {

    var tabela = document.getElementById("tabela");

    var linhas = ""

    var listaRanking = []

    for (var i = 0; i < macServidor.length; i++) {
        var mac = macServidor[i];

        // Cria um objeto para cada servidor e salva em listaRaking
        var obj = {
            mac: mac,
            nome: nomesServidores[mac], // se tiver isso
            leve: terAlertaLevesServidores[mac] != undefined ? terAlertaLevesServidores[mac] : null,
            grave: terAlertaGravesServidores[mac] != undefined ? terAlertaGravesServidores[mac] : null
        };

        listaRanking.push(obj);

    }

    //  Ordenar por quem vai ter o alerta primeiro
    // Selection short

        for (var i = 0; i < listaRanking.length - 1; i++) {

        var indiceMenor = i

        for (var j = i + 1; j < listaRanking.length; j++) {

            // ---- valor do j ----
            var tempoA

            if (listaRanking[j].grave !== null && listaRanking[j].grave !== undefined) {
                tempoA = listaRanking[j].grave;
            } else if (listaRanking[j].leve !== null && listaRanking[j].leve !== undefined) {
                tempoA = listaRanking[j].leve;
            } else {
                tempoA = Infinity;
            }

            // ---- valor do índiceMenor ----
            var tempoB;

            if (listaRanking[indiceMenor].grave !== null && listaRanking[indiceMenor].grave !== undefined) {
                tempoB = listaRanking[indiceMenor].grave;
            } else if (listaRanking[indiceMenor].leve !== null && listaRanking[indiceMenor].leve !== undefined) {
                tempoB = listaRanking[indiceMenor].leve;
            } else {
                tempoB = Infinity;
            }

            // compara os tempos de execução
            if (tempoA < tempoB) {
                indiceMenor = j;
            }
        }

        // Troca
        if (indiceMenor != i) {
            var aux = listaRanking[i];
            listaRanking[i] = listaRanking[indiceMenor];
            listaRanking[indiceMenor] = aux;
        }
    }

    // -----------------------------------------------------------------
    // Monta as linhas da tabela em si
    // ----------------------------- ----------------------------------
    for (var i = 0; i < listaRanking.length; i++) {

        var sv = listaRanking[i];
        var cor = "green"
        var tempo = "-"

        if (sv.grave !== null) {
            cor = "red"
            tempo = sv.grave.toFixed(2)
        }
        else if (sv.leve !== null) {
            cor = "orange"
            tempo = sv.leve.toFixed(2)
        }

        linhas += 
            "<tr>" +
                '<td><img src="../../assets/imgs/bandeira_brasil.png" width="50%"></td>' +
                "<td>" + sv.nome + "</td>" +
                '<td style="color:' + cor + '; font-weight:bold;">' + tempo + "</td>" +
            "</tr>"
    }

    // Preencher tabela
    tabela.innerHTML =
        "<tr>" +
            "<th>Pais</th>" +
            "<th>Servidor</th>" +
            "<th>Previsão</th>" +
        "</tr>" +
        linhas
}






// -------------------------------------------------------------------
// Fazendo a logica de pegar os dados para o grafico de linhas
// -------------------------------------------------------------------

let mediasCPUvar = []
let mediasRAMvar = []
let previsoesCPUvar = []
let previsoesRAMvar = []

 async function grafLinha() {
            

            let NOME_ARQUIVO = `resumo.csv`;
            let URL_API = `/s3Route/dados/${NOME_ARQUIVO}`;
            

            
            // Referência ao canvas principal e ao container auxiliar para mensagens de erro
            
            // const ctx = document.getElementById('grafico');
            // const carregamento = document.getElementById('area_comparativo_servidores');
            
            // carregamento.innerHTML = 'Carregando dados...'; 
            
            try {
                // requisição à API
                let resposta = await fetch(URL_API);

            // descreve erros 
            if (!resposta.ok) {
                let erroDetalhe = await resposta.text();
                throw new Error(`Erro ${resposta.status}: Falha na API: ${erroDetalhe.substring(0, 100)}`);
            }
            
            // converte a resposta para JSON!!!!!
            let data = await resposta.json();

            // // limpa a mensagem de carregamento
            // carregamento.innerHTML = '';
            // carregamento.appendChild(ctx); // Garante que o canvas volte

            // verifica e Processa os Dados para o Chart.js
            if (!Array.isArray(data) || data.length === 0) {
                console.warn("Erro nos dados recebidos");
                // carregamento.innerHTML = `<div style="color: orange; padding: 20px;">⚠️ Dados vazios para plotar o gráfico.</div>`;
                return;
            }


            // extrai os valores para os eixos


            mediasCPUvar = data.map(d => Number(d[mediasCPU])).slice(-30); // esse .slice(-30) corta os ultimos 30 valores do vetor
            mediasRAMvar = data.map(d => Number(d[mediasRAM])).slice(-30);

            previsoesCPUvar = data.map(d => Number(d[previsoesCPU])).slice(-45);
            previsoesRAMvar = data.map(d => Number(d[previsoesRAM])).slice(-45);



            // Se for a ultima chamada dessa função, ela faz o codigo abaixo, que gera o predict de alerta pra cada servidor
        }
                 catch (error) {
            // Captura e exibe erros
            console.error("Erro ao carregar os dados:", error);
        }

        console.log("");
        

        // --------------------------------------------------------------------
        // Logica da criação do grafico de linha em si e da separação dos dados
        // --------------------------------------------------------------------


        //Premissa: os dados vem do mais antigo para o mais recente -> tem que confirmar isso




        const ctx = document.getElementById('grafico').getContext('2d');
        

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: gerarDias(),
                datasets: [{
                    label: 'CPU usada',
                    data: mediasCPUvar,
                    borderColor: '#004C99',
                    borderWidth: 3,
                    fill: false,
                    tension: 0.4,
                    pointRadius: 0,
                },{
                    label: 'CPU prevista',
                    data: previsoesCPUvar,
                    borderColor: '#00BCD4',
                    borderWidth: 3,
                    fill: false,
                    borderDash: [5, 5],
                    tension: 0.4,
                    pointRadius: 0,
                },
                {
                    label: 'RAM usada',
                    data: mediasRAMvar,
                    borderColor: '#A9A9A9',
                    borderWidth: 3,
                    fill: false,
                    tension: 0.4,
                    pointRadius: 0,
                },{
                    label: 'RAM prevista',
                    data: previsoesRAMvar,
                    borderColor: '#B3E5FC',
                    borderWidth: 3,
                    fill: false,
                    borderDash: [5, 5],
                    tension: 0.4,
                    pointRadius: 0,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true },
                    title: {
                        display: true,
                        text: 'Evolução e previsão da media mensal de uso de CPU e RAM (ultimos 30 e proximos 15 dias)',
                        color: 'white',
                        font: {
                            size: 20,
                            weight: 'bold',
                            family: 'Open Sans'
                        },
                        align: 'center',
                        padding: {
                            bottom: 20
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: { color: 'white' },
                        grid: { display: false }
                    },
                    y: {
                        ticks: { color: 'white' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    }
                },
                layout: {
                    padding: 10
                }
            }
        });

    }







function gerarDias() {
    var labels = [];

    var hoje = new Date();

    // 29 dias pra tras
    for (var i = 29; i > 0; i--) {
        var data = new Date(hoje);
        data.setDate(hoje.getDate() - i);

        var dia = String(data.getDate()).padStart(2, "0");
        var mes = String(data.getMonth() + 1).padStart(2, "0");

        labels.push(dia + "/" + mes);
    }

    // dia de hoje
    var diaAtual = String(hoje.getDate()).padStart(2, "0");
    var mesAtual = String(hoje.getMonth() + 1).padStart(2, "0");
    labels.push(diaAtual + "/" + mesAtual);

    //  15 dias pra frente
    for (var j = 1; j <= 15; j++) {
        var futura = new Date(hoje);
        futura.setDate(hoje.getDate() + j);

        var dia = String(futura.getDate()).padStart(2, "0");
        var mes = String(futura.getMonth() + 1).padStart(2, "0");

        labels.push(dia + "/" + mes);
    }

    return labels;
}


</script>

</html>


